<div class="card m-2 shadow">
  <div class="card-body">

    <%= form_for(@role) do |form| %>
      <% if role.errors.any? %>
        <div id="error_explanation">
          <h2><%= pluralize(role.errors.count, "error") %> prohibited this role from being saved:</h2>
          <ul><% role.errors.full_messages.each do |message| %><li><%= message %></li><% end %></ul>
        </div>
      <% end %>

      <div class="form-group row justify-content-center">
        <%= form.label 'Nombre', class: 'col-sm-1 col-form-label text-right' %>
        <div class="col-md-3">
          <%= form.text_field :name, id: :role_name, class: "form-control" %>
        </div>
      </div>

      <h2 class="text-center m-4">Permisos</h2>

      <div class="row">
        <% ModelType.all.each do |mt| %>
          <div class="col-md-2 mb-2">
            <legend><%= mt.name %></legend>
            <% Event.all.each do |e| %>
              <% if params[:action] == 'new' %>
                <%= check_box_tag "permissions[#{mt.id}][#{e.id}]" %>
                <%= e.name %>
              <% else %>
                <div class="form-group">
                  <div class="custom-control custom-switch">
                    <%= check_box_tag "permissions[#{mt.id}][#{e.id}]",e.id , @permissions.any? {|c| c.event_id == e.id && c.model_type_id == mt.id}, class: 'custom-control-input', id: "chk#{mt.name}#{e.name}" %>
                    <label class="custom-control-label" for="<%="chk#{mt.name}#{e.name}"%>"><%= e.name %></label>
                  </div>
                </div>
              <% end %>
            <% end %>
          </div>
        <% end %>
      </div>

      <div class="row justify-content-center">
        <%= link_to t('.cancel', :default => t("helpers.links.cancel")), roles_path, :class => 'btn btn-secondary mr-1' %>
        <%= form.submit class: 'btn btn-primary', value: "Guardar" %>
      </div>

    <% end %>

  </div>
</div>
