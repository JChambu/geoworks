table = '<%= @table %>';
field_name = '<%= @field_name %>';
field_key = '<%= params[:q][:project_field]%>';
operator = '<%= raw params[:q][:filters] %>';
value = '<%= params[:q][:input_value] %>';

// Aplica modificaciones si el value es array
if (value.match(/&quot;/g) != null) {
  value = value.replace(/&quot;/g, '\"')
  value_view = value.replace(/[\[\]\"]/g, "")
} else {
  value_view = value
}

var filter = field_key + '|' + operator + '|\'' + value + '\'';
var filter_view = field_name  + " " + operator + " " + value_view;

// Guarda el filtro dependiendo si es para la tabla padres o hijos
if (table == 'Formularios') {
  Navarra.project_types.config.filter_option.push(filter);
} else {
  // Navarra.project_types.config.filter_option.push(padres_filtrados);
}

// Elimina y vuelve a agregar el item al card Filtros Activos
$('#filter-body').append(
  $('<div>', { // item
    'class': 'message text-light bg-secondary px-2 mb-1 py-1 rounded border border-dark shadow',
    'id': filter,
    'value': filter
  }).append(
    $('<b>', {
      'text': 'Filtrado por: '+filter_view
    }),
    $('<button>', {
      'type': 'button',
      'class': 'close',
      'id': 'close_point_color',
      'text': 'Ã—'
    })
  )
)

resize_graphics();

$("#filters-modal").modal('hide');
//$("#filters-modal").remove();
$(".fa-filter").css("color", "#d3d800");
var point_color = Navarra.project_types.config.field_point_colors;
if(point_color == ''){
    Navarra.geomaps.wms_filter();
}else{
    Navarra.geomaps.point_colors_data();
}
