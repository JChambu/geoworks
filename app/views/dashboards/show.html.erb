<%= content_for :head do %>

  <script type="text/javascript">
    <% if !@project_type.nil? %>
      Navarra.dashboards.config.project_type_id = <%= @project_type.id %>
      Navarra.dashboards.config.current_tenant = '<%= @current_tenant %>';
      Navarra.dashboards.config.name_layer = '<%= @project_type.name_layer %>';
      Navarra.dashboards.config.type_geometry = '<%= @project_type.type_geometry %>';
    <% end %>
    <% if !@dashboard.nil? %>
      Navarra.dashboards.config.dashboard_id = <%= @dashboard.id %>
    <% end %>
  <% if @extent.length > 0  %>
      Navarra.dashboards.config.minx = <%= @extent[0].minx %>
      Navarra.dashboards.config.miny = <%= @extent[0].miny  %>
      Navarra.dashboards.config.maxx = <%= @extent[0].maxx  %>
      Navarra.dashboards.config.maxy = <%= @extent[0].maxy %>
    <% end %>
    <% if !@projects.nil? %>
      <% @projects.each do |a|%>
        <%if !a.the_geom.nil?  %>
          <% if @project_type.type_geometry != 'Polygon' %>
            Navarra.dashboards.config.lat.push( <%= a.the_geom.y %>)
            Navarra.dashboards.config.lon.push( <%= a.the_geom.x %>)
          <% end %>
        <% end %>
      <% end %>
    <% end %>
    <% if @project_filters %>
      <% @project_filters.each do |s| %>
        <% s.properties.each do |p|  %>
          Navarra.project_types.config.filter_option.push('<%= p[0] %>');
          Navarra.project_types.config.filter_option.push('=');
          Navarra.project_types.config.filter_option.push('<%= p[1] %>');
        <% end %>
      <% end %>
    <% end %>
  </script>
<% end %>

<div class="fakeLoader"></div>
<div id="firewall-content"></div>

<div class="modal fade" id="modal-window" tabindex="-1" role="dialog" aria-labelledby="chartModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content"></div>
  </div>
</div>

<%= form_for :q, :html => {:class => '', :method => :get} do |f| %>

  <div id="wait" class="modal fade">
    <i class="fa fa-pie-chart fa-5x loadingBar"></i>
  </div>

  <div class="row m-0">
    <div id="map"></div>
    <div class="graphics row m-0 pt-2 px-2">
      <div class="card text-light chart-bg-transparent sticky-top w-100 mb-2" id="filter-container">
        <div class="card-header chart-header-bg-transparent py-1 px-2" id="filter-header">
          <button class="close" type="button" data-toggle="collapse" data-target="#collapse_filter" aria-expanded="true" aria-controls="collapse_filter"><i class="fas fa-window-minimize" style="font-size: 15px"></i></button>
          Filtros Activos
        </div>
        <div class="collapse show" id="collapse_filter">
          <div class="card-body" id="filter-body"></div>
        </div>
      </div>
    </div>
  </div>

<% end %>
